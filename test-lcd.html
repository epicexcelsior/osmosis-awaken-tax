<!DOCTYPE html>
<html>
<head>
    <title>LCD Endpoint Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
        }
        .endpoint {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background: #d4edda; border-left: 4px solid #28a745; }
        .error { background: #f8d7da; border-left: 4px solid #dc3545; }
        .loading { background: #fff3cd; border-left: 4px solid #ffc107; }
        pre { background: #f8f9fa; padding: 10px; overflow-x: auto; }
        button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover { background: #0056b3; }
        input {
            padding: 8px;
            width: 400px;
            font-size: 14px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>LCD Endpoint Test</h1>
    
    <div>
        <input type="text" id="address" value="osmo1g8gv8ayl55698fscstajt9uqw9r6w8a34aly9v" placeholder="Enter address">
        <button onclick="runTest()">Test Endpoints</button>
    </div>
    
    <div id="results"></div>

    <script>
        const endpoints = [
            'https://lcd.osmosis.zone',
            'https://osmosis-api.polkachu.com', 
            'https://api.osmosis.interbloc.org',
            'https://osmosis-rest.publicnode.com'
        ];

        async function runTest() {
            const address = document.getElementById('address').value;
            const results = document.getElementById('results');
            results.innerHTML = '';
            
            for (const endpoint of endpoints) {
                const url = `${endpoint}/cosmos/tx/v1beta1/txs?events=message.sender='${address}'&pagination.limit=10`;
                const div = document.createElement('div');
                div.className = 'endpoint loading';
                div.innerHTML = `<strong>${endpoint}</strong><br>Loading...<br><code>${url}</code>`;
                results.appendChild(div);
                
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000);
                    
                    const response = await fetch(url, { 
                        signal: controller.signal,
                        headers: { 'Accept': 'application/json' }
                    });
                    clearTimeout(timeoutId);
                    
                    if (response.ok) {
                        const data = await response.json();
                        const txCount = data.tx_responses?.length || 0;
                        div.className = 'endpoint success';
                        div.innerHTML = `
                            <strong>${endpoint}</strong> 
                            <span style="color: green;">✓ Status ${response.status}</span><br>
                            Found ${txCount} transactions<br>
                            <details>
                                <summary>View Response</summary>
                                <pre>${JSON.stringify(data, null, 2).substring(0, 2000)}...</pre>
                            </details>
                        `;
                    } else {
                        const text = await response.text();
                        div.className = 'endpoint error';
                        div.innerHTML = `
                            <strong>${endpoint}</strong> 
                            <span style="color: red;">✗ Status ${response.status}</span><br>
                            <pre>${text.substring(0, 500)}</pre>
                        `;
                    }
                } catch (error) {
                    div.className = 'endpoint error';
                    div.innerHTML = `
                        <strong>${endpoint}</strong> 
                        <span style="color: red;">✗ Error</span><br>
                        ${error.message}
                    `;
                }
            }
        }

        // Auto-run on load
        window.onload = runTest;
    </script>
</body>
</html>
